<section class="section popular-services">
	<div class="container">
		<!-- Heading title-->
		<div class="section-heading" data-aos="fade-down">
			<h2>Một số mẫu áo nổi bật</h2>
		</div>
		<!-- /Heading title -->

		<div class="row">
			<div class="popular-slider-group">
				<div class="owl-carousel rental-deal-slider owl-theme">
					@{
						List<Product> items = ViewBag.LatestItems;
						foreach (var item in items)
						{
							<div class="rental-car-item">
								<div class="listing-item mb-0">
									<div class="listing-img">
										<a asp-controller="Product" asp-action="Detail" asp-route-id="@item.ProductId">
											<img src="@item.Image" alt="@item.ProductName" class="product-fixed-img">
										</a>
									</div>
									<div class="listing-content">
										<div class="listing-features">
											<h3 class="listing-title">
												<a asp-controller="Product" asp-action="Detail" asp-route-id="@item.ProductId">
													@item.ProductName
												</a>
											</h3>
											<h4 class="text-danger">@item.UnitPrice₫</h4>
										</div>
										<div class="listing-button">
											@{
												var username = Context.Session.GetString("Username");
												var returnUrl = Context.Request.Path + Context.Request.QueryString;
											}
											<form asp-controller="Cart" asp-action="AddToCart" method="post">
												<input type="hidden" name="Username" value="@username" />
												<input type="hidden" name="ProductId" value="@item.ProductId" />
												<input type="hidden" name="Quantity" value="1" />
												<input type="hidden" name="returnUrl" value="@returnUrl" />
												<button type="submit" class="btn btn-order">
													<span><i class="feather-calendar me-2"></i></span>Đặt hàng ngay!
												</button>
											</form>
											<button type="button" class="btn btn-order mt-2"
													onclick="openModal(@item.ProductId, '@item.ProductName')">
												<span><i class="feather-send me-2"></i></span>Liên hệ đặt hàng
											</button>
										</div>
									</div>
								</div>
							</div>
						}
					}

				</div>
				<!-- Modal chung (đặt ngoài foreach) -->
				<div id="contactModal" class="modal">
					<div class="modal-content">
						<span class="close" onclick="closeModal()">&times;</span>
						<h3 id="modalTitle" class="text-center font-bold mb-3"></h3>
						<form asp-controller="Email" asp-action="Submit" method="post" enctype="multipart/form-data">
							<input type="hidden" name="ProductId" id="modalProductId" />
							<div class="form-group mb-2">
								<label>Họ và tên</label>
								<input type="text" name="FullName" placeholder="Họ và tên *" class="form-control" required />
							</div>
							<div class="form-group mb-2">
								<label>Số điện thoại</label>
								<input type="tel" name="Phone" placeholder="Số điện thoại *" class="form-control" required />
							</div>
							<div class="form-group mb-2">
								<label>Email</label>
								<input type="email" name="Email" placeholder="Email *" class="form-control" required />
							</div>
							<div class="form-group mb-2">
								<label>Số điện thoại</label>
								<input type="number" name="Quantity" placeholder="Số lượng cần tư vấn *" class="form-control" required />
							</div>
							<div class="form-group mb-2">
								<input type="file" name="File" class="form-control" required />
							</div>
							<div class="form-group mb-2">
								<label>Lời nhắn</label>
								<textarea name="Note" placeholder="Nội dung thiết kế (càng chi tiết càng tốt)" class="form-control"></textarea>
							</div>
							<button type="submit" class="btn btn-primary w-100 mt-3">Gửi yêu cầu</button>
						</form>
					</div>
				</div>
			</div>
		</div>

		<!-- View More -->
		<div class="view-all text-center" data-aos="fade-down">
			<a asp-controller="Product" class="btn btn-view d-inline-flex align-items-center">
				Xem tất cả sản phẩm
				<span><i class="feather-arrow-right ms-2"></i></span>
			</a>
		</div>
		<!-- /View More -->
	</div>
</section>


<style>
	.product-fixed-img {
		width: 255px;
		height: 365px;
		object-fit: cover; /* giữ tỉ lệ, cắt cho vừa khung */
		border-radius: 8px; /* bo góc nếu cần */
		display: block;
		margin: 0 auto; /* căn giữa ảnh */
	}

	.modal {
		display: none;
		position: fixed;
		z-index: 1000;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		background: rgba(0,0,0,0.6);
		justify-content: center;
		align-items: center;
	}

	.modal-content {
		background: #fff;
		padding: 20px;
		border-radius: 10px;
		width: 400px;
		max-width: 90%;
	}

	.modal.active {
		display: flex;
	}

	.modal .close {
		float: right;
		font-size: 20px;
		cursor: pointer;
	}

</style>
<!-- /Rental deals -->
<script>
	function openModal(productId, productName) {
		document.getElementById("modalTitle").innerText = "Liên hệ đặt hàng: " + productName;
		document.getElementById("modalProductId").value = productId;
		document.getElementById("contactModal").classList.add("active");
	}

	function closeModal() {
		document.getElementById("contactModal").classList.remove("active");
	}
</script>



